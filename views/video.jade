extends layout

block content

  div.row.wrapper
  
    //- Main video column
    div.col-lg-8.primary-video-col
      div#featured
        video(controls width="100%")
          source(src="#{mainVideo.url}")
        
      div#videoBar.mt-2
        h3.my-2 #{mainVideo.title}
        a(href="#").user
          img(src="/#{mainVideo.publisher.profileImage}")    
        span.username #{mainVideo.publisher.username}
        hr
        div.text-xs-right
          i.fa.fa-thumbs-o-up
          span Likes: #{mainVideo.likes}
          i.fa.fa-eye
          span Views: #{mainVideo.views}
        
      //- Video Description
      div#videoBar2.mt-2
        strong
          p Published on 
            span #{mainVideo.published_at.toDateString().slice(3).replace(' 201', ', 201')}    
        p #{mainVideo.desc}
        hr
        p.text-xs-center 
          strong Show more
      
      
      //- Comments section
      div#commentsBar.my-2
        span.lead.pl-2 Comments - #{mainVideo.comments.length}
        hr
        //do some angular stuff for adding comments
        div.row
        form(method="post" action="/video/addcomment/#{mainVideo._id}")
          .form-group
            a(href="#").user
              if user
                img(src="/#{user.profileImage}")  
              if !user
                img(src="/uploads/default.jpg")  
            textarea(name="comment_body" placeholder="Add a public comment...")
          .form-group 
            button(type="submit") Comment
            
          //- Display all comments
          each comment, i in mainVideo.comments.reverse()
            div.comment-container.py-2
              //- a(href="/#{comment}") profile page
              img(src="/#{comment.profileImage}")
              strong.mx-1
                span#comment-username #{comment.username}
              span #{comment.comment_date.toDateString().slice(3).replace(' 201', ', 201')}
            p.py-1.px-1 #{comment.comment_body}
              hr
            
      
      
    //- Public video column
    div.col-lg-4.bg-primary
      h1 Public Videos
      each publicVideo, i in publicVideos
        if (publicVideo.url !== mainVideo.url)
          div.col-xs-8
            h4 #{publicVideo.title}
            p #{publicVideo.desc}
            a(href="/video/#{publicVideo._id}") 
              video(width="100%")
                source(src="#{publicVideo.url}")
            div.text-xs-center  
              span Likes: #{publicVideo.likes}
              span Views: #{publicVideo.views}
            div Published: 
              span #{publicVideo.published_at.toDateString()}
        
